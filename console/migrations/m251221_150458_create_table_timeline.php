<?php

use yii\db\Migration;

class m251221_150458_create_table_timeline extends Migration
{
    /**
     * {@inheritdoc}
     */
    public function safeUp()
    {
        $tableOptions = null;
        if ($this->db->driverName === 'mysql') {
            $tableOptions = 'CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ENGINE=InnoDB';
        }

        $this->createTable('{{%timeline}}', [
            'id' => $this->primaryKey()->comment('主键ID'),
            'phase' => $this->string(50)->notNull()->comment('阶段：局部抗战、全面抗战'),
            'order' => $this->integer()->notNull()->defaultValue(0)->comment('显示顺序'),
            'title' => $this->string(200)->notNull()->comment('事件标题'),
            'subtitle' => $this->string(200)->comment('副标题'),
            'date' => $this->string(50)->comment('日期'),
            'alias' => $this->string(200)->comment('事件别称'),
            'description' => $this->text()->notNull()->comment('事件描述'),
            'image_path' => $this->string(500)->comment('图片路径'),
            'image_caption' => $this->string(500)->comment('图片说明'),
        ], $tableOptions);

        $this->createIndex('idx-phase-order', '{{%timeline}}', ['phase', 'order']);
        $this->createIndex('idx-phase', '{{%timeline}}', 'phase');

        $this->insertInitialData();
    }

    /**
     * {@inheritdoc}
     */
    public function safeDown()
    {
        $this->dropTable('{{%timeline}}');
    }

    private function insertInitialData()
    {
        $this->batchInsert('{{%timeline}}', 
            ['order', 'phase', 'title', 'subtitle', 'date', 'alias', 'description', 'image_path', 'image_caption'], 
            [
                [
                    1,
                    '局部抗战',
                    '九一八事变',
                    '日本武装侵占中国东北的开始',
                    '1931年9月18日',
                    '沈阳事变、柳条湖事件',
                    '1931年9月18日夜，日本关东军自行炸毁沈阳柳条湖附近南满铁路的一段路轨，反诬中国军队所为，并以此为借口，突然袭击东北军驻地北大营和沈阳城。由于国民政府采取“不抵抗政策”，日军在短短数月内迅速占领了中国东北三省，并在此后扶植建立伪“满洲国”。这一事变标志着日本帝国主义全面侵华战争的序幕正式拉开，也是中国局部抗战的起点。',
                    '',
                    '',
                ],
                [
                    2,
                    '局部抗战',
                    '一二八事变',
                    '淞沪抗战',
                    '1932年1月28日',
                    '第一次上海事变',
                    '1932年1月28日深夜，日本海军陆战队向上海闸北一带发起进攻。驻守上海的国民革命军第十九路军在总指挥蒋光鼐、军长蔡廷锴的率领下，违背国民政府意志，奋起抵抗。随后，张治中率领第五军也加入战斗。中国军队英勇抵抗达一个多月，迫使日军三易主帅，沉重打击了日军的侵略气焰。此次事变激起了全国人民的抗日热情，但最终以签订《淞沪停战协定》告终。',
                    '',
                    '',
                ],
                [
                    3,
                    '局部抗战', 
                    '长城抗战',
                    '中国军队在长城沿线抗击日军',
                    '1933年',
                    '热河抗战',
                    '1933年，日军侵占热河（今分属河北、辽宁、内蒙古）后，继续向长城各关口进犯，企图打开华北门户。中国军队包括西北军、东北军、中央军等部在长城沿线的冷口、喜峰口、古北口等地进行了顽强阻击。其中，第二十九军在喜峰口以大刀队夜袭日军，取得“喜峰口大捷”，极大鼓舞了全国士气。但由于敌我力量悬殊和国民政府谋求妥协，长城抗战最终失利，并签订了屈辱的《塘沽协定》。',
                    '',
                    '',
                ],
                [
                    4,
                    '局部抗战',
                    '一二九运动',
                    '中国共产党领导的大规模学生爱国运动',
                    '1935年12月9日',
                    '一二九抗日救亡运动',
                    '在日本策动“华北自治”、中华民族危机空前严重的背景下，1935年12月9日，在中共北平临时工委的领导下，北平（今北京）大中学生数千人冲上街头，举行声势浩大的抗日救国示威游行，反对“华北自治”，要求“停止内战，一致抗日”。游行遭到国民党军警的残酷镇压。这场运动迅速得到全国人民的响应，形成了全国性的抗日救亡高潮，极大地促进了中华民族的觉醒，为全民族抗战奠定了重要的思想和群众基础。',
                    '',
                    '',
                ],
                [
                    5,
                    '局部抗战',
                    '西安事变',
                    '逼蒋抗日，促成抗日民族统一战线', 
                    '1936年12月12日',
                    '双十二事变',
                    '1936年12月12日，国民党爱国将领张学良和杨虎城为了劝谏蒋介石停止内战、一致抗日，在西安发动“兵谏”，扣留了蒋介石及其随行军政要员。事变发生后，中共中央派周恩来等人赴西安斡旋，最终以和平方式解决。蒋介石被迫接受了“停止剿共，联红抗日”等六项条件。西安事变的和平解决，成为时局转换的枢纽，基本结束了十年内战，标志着抗日民族统一战线的初步形成。',
                    '',
                    '',
                ],
                [1, '全面抗战', '卢沟桥事变', '全民族抗战的起点', '1937年7月7日', '七七事变', '1937年7月7日晚，日军在北平西南卢沟桥附近进行军事演习，诡称一名士兵失踪，要求进入宛平县城搜查，遭到中国守军严词拒绝。日军随即炮轰宛平城和卢沟桥，中国守军第二十九军三十七师（师长冯治安）吉星文团奋起抵抗。卢沟桥事变标志着日本帝国主义全面侵华战争的开始，也标志着中国全民族抗战的爆发，开辟了世界反法西斯战争的东方主战场。', '', '',],
                [2, '全面抗战', '淞沪会战', '抗战初期规模最大、最惨烈的战役', '1937年8月13日至11月12日', '八一三事变、第二次上海事变', '1937年8月13日，中日双方在上海及其周边地区展开了一场战略性会战。蒋介石调动了当时最精锐的中央军和大批地方部队，总兵力约70万，与日军展开血战。战役持续了三个月，中国军队浴血奋战，粉碎了日本“三个月灭亡中国”的狂妄计划，展现了中国人民的抗战决心。但中国军队也付出了极其惨重的伤亡，最终被迫撤退。上海失陷，会战结束。', '', '',],
                [3, '全面抗战', '平型关大捷', '八路军出师抗日首战告捷', '1937年9月25日', '平型关伏击战', '1937年9月，八路军第一一五师根据总部指示，在山西省灵丘县平型关附近伏击日军。25日拂晓，日军第五师团（板垣师团）第二十一旅团一部及辎重车队进入伏击圈，第一一五师突然发起猛攻，经过激烈战斗，歼灭日军1000余人，击毁汽车100余辆，缴获大量军用物资。平型关大捷是全国抗战以来中国军队取得的第一个重大胜利，打破了“日军不可战胜”的神话，极大地振奋了全国军民的抗战信心。', '', '',],
                [4, '全面抗战', '南京大屠杀', '日军制造的惨绝人寰的大屠杀', '1937年12月', '南京惨案', '1937年12月13日，日军攻陷中华民国首都南京。在随后长达六周的时间里，日军在南京及附近地区进行了有组织、有计划、有预谋的大规模屠杀、强奸、纵火、抢劫等暴行。遇难人数超过30万，无数家庭支离破碎。南京大屠杀是日本军国主义在侵华战争期间犯下的最骇人听闻的暴行之一，是人类历史上极其黑暗的一页。', '', '',],
                [5, '全面抗战', '台儿庄战役', '抗战以来正面战场最大胜利', '1938年3月至4月', '台儿庄大捷', '1938年春，日军精锐部队矶谷师团和板垣师团企图会师台儿庄，进而攻取徐州。中国军队在第五战区司令长官李宗仁的指挥下，以孙连仲第二集团军等部死守台儿庄，以汤恩伯军团在外线迂回。经过近一个月的激战，中国军队最终包围并重创日军，歼敌约1万余人。台儿庄大捷是全面抗战爆发后中国正面战场取得的首次重大胜利，沉重打击了日军的嚣张气焰。', '', '',],
                [6, '全面抗战', '武汉会战', '战略防御阶段规模最大战役', '1938年6月至10月', '武汉保卫战', '1938年6月，日军为迫使中国政府屈服，集结重兵进攻当时中国的政治、军事中心——武汉。中国军队在第九战区司令长官陈诚、第五战区等部协同下，于武汉外围沿长江南北两岸展开防御，战场遍及安徽、河南、江西、湖北四省。会战持续四个多月，大小战斗数百次，消耗了日军大量有生力量。虽然武汉最终失守，但日军的战略进攻至此达到顶点，抗日战争进入战略相持阶段。', '', '',],
                [1, '战略相持', '百团大战', '八路军在华北发动的战略性进攻战役', '1940年8月至1941年1月', '正太路破袭战', '为粉碎日军的“囚笼政策”，克服国民政府的妥协危险，振奋全国抗战信心，八路军总部在彭德怀指挥下，出动105个团约20万兵力，在华北地区对日军控制的主要交通线（如正太铁路）和据点发动了一次大规模战略性进攻。战役分为三个阶段，经历了交通破袭战、攻坚战和反“扫荡”作战，沉重打击了日伪军，提高了共产党和八路军的威望。', '', '',],
                [2, '战略相持', '皖南事变', '国民党顽固派制造的严重反共事件', '1941年1月', '新四军事件', '1941年1月4日，奉命北移的新四军军部及所属部队共9000余人，在安徽泾县茂林地区遭到国民党军8万多人的伏击和围攻。新四军官兵血战七昼夜，除约2000人突围外，大部牺牲或被俘，军长叶挺被扣押，副军长项英遇害。蒋介石随即宣布取消新四军番号。这一事变是国民党第二次反共高潮的最高峰，严重破坏了抗日民族统一战线。', '', '',],
                [3, '战略相持', '第三次长沙会战', '珍珠港事件后盟军首次大捷', '1941年12月至1942年1月', '长沙大捷', '1941年12月，日军为配合其在东南亚的进攻，防止中国军队南下支援英军，再次进攻长沙。第九战区司令长官薛岳采用“天炉战法”，诱敌深入，将日军诱至长沙城下后，集中优势兵力进行包围反击。中国军队取得重大胜利，毙伤日军5万余人。此次会战发生在太平洋战争爆发后不久，在国内外产生了重大影响，被视为同盟国的首次重大军事胜利。', '', '',],
                [4, '战略相持', '中国远征军入缅作战', '中国与盟军直接进行军事合作的典范', '1942年', '滇缅路作战', '为保卫中国西南大后方唯一的国际交通线——滇缅公路，并协助盟国在英国殖民地缅甸抗击日军，中国于1942年初组建远征军，进入缅甸与英军协同作战。虽在初期取得同古保卫战等局部胜利，但因中英战略分歧和指挥混乱，导致作战失利，远征军主力被迫历经艰险分别撤回国内或退入印度。此次入缅作战是中国从战略防御进入战略反攻的重要一环，展现了中国军队的国际主义精神。', '', '',],
                [5, '战略相持', '狼牙山五壮士', '八路军战士英勇不屈的典范', '1941年9月25日', '狼牙山战斗', '1941年秋，日军对晋察冀边区进行大“扫荡”。9月25日，八路军晋察冀军区一分区一团七连六班班长马宝玉、副班长葛振林和战士胡德林、胡福才、宋学义，为掩护主力部队和群众转移，将日军引向狼牙山主峰棋盘陀。在弹尽粮绝的情况下，五人宁死不屈，纵身跳下悬崖。马宝玉、胡德林、胡福才壮烈殉国，葛振林和宋学义被山腰树枝挂住，幸免于难。他们的壮举表现了中华民族的英雄气概。', '', '',],
                [1, '战略反攻', '车桥战役', '华中敌后战场反攻的起点', '1944年3月', '车桥战斗', '1944年3月，新四军第一师在师长兼政委粟裕的指挥下，在江苏省淮安县车桥地区对日伪军发动进攻。此次战役采取攻坚与打援相结合的方式，共歼灭日军460余人、伪军480余人，摧毁碉堡53座。车桥战役的胜利，打通了苏中与苏北、淮南、淮北根据地的联系，标志着华中敌后战场由战略相持转入战略反攻。', '', '',],
                [2, '战略反攻', '豫湘桂战役', '日军最后的战略进攻', '1944年4月至12月', '大陆打通作战、一号作战', '为打通从中国东北到越南的大陆交通线，并摧毁中美空军基地，日军于1944年4月发动了侵华战争中规模最大的一次进攻战役。战役贯穿河南、湖南、广西等地。国民党军队在战役中遭遇惨重失败，损失兵力数十万，丢失了包括郑州、长沙、衡阳、桂林在内的146座城市和7个空军基地，激起了全国人民的极大愤慨。', '', '',],
                [3, '战略反攻', '中共七大召开', '团结的大会，胜利的大会', '1945年4月至6月', '中国共产党第七次全国代表大会', '1945年4月23日至6月11日，中国共产党在延安召开了第七次全国代表大会。大会系统总结了建党24年来的经验，确立了毛泽东思想为党的指导思想并写入党章；制定了“放手发动群众，壮大人民力量，在我党的领导下，打败日本侵略者，解放全国人民，建立一个新民主主义的中国”的政治路线。这次大会为夺取抗日战争的最后胜利和新民主主义革命在全国的胜利，奠定了政治和思想基础。', '', '',],
                [4, '战略反攻', '苏联出兵东北', '对日宣战，加速日本投降', '1945年8月9日', '八月风暴行动', '根据雅尔塔协定，苏联于1945年8月8日对日宣战。9日零时，苏联红军三个方面军百万余人从东、西、北三个方向，在四千多公里的战线上越过中苏、中蒙边境，向日本关东军发动猛烈进攻。苏军的进攻势如破竹，迅速歼灭关东军主力，加速了日本法西斯的覆灭进程，对中国战场转入全面反攻起到了直接的推动作用。', '', '',],
                [1, '胜利时刻', '美国投掷原子弹', '加速日本投降进程', '1945年8月6日、9日', '广岛长崎原子弹爆炸', '为迫使日本尽快投降，并减少盟军伤亡，美国于1945年8月6日在日本广岛投下第一颗代号“小男孩”的原子弹；8月9日，又在长崎投下第二颗代号“胖子”的原子弹。原子弹爆炸造成了巨大的人员伤亡和城市毁灭，给日本统治集团带来极大的心理震慑，是促使日本最终决定无条件投降的重要因素之一。', '', '',],
                [2, '胜利时刻', '日本宣布无条件投降', '中国人民抗日战争取得最终胜利', '1945年8月15日', '日本终战', '在遭受中国战场长期消耗、美国原子弹轰炸和苏联出兵东北的多重打击下，日本法西斯已陷入绝境。1945年8月15日正午，日本裕仁天皇通过广播发表《终战诏书》，宣布接受《波茨坦公告》，无条件投降。这一宣告标志着中国人民经过长达14年艰苦卓绝的斗争，终于取得了抗日战争的伟大胜利。', '', '',],
                [3, '胜利时刻', '日本签署投降书', '第二次世界大战正式结束', '1945年9月2日', '密苏里号受降仪式', '1945年9月2日上午，在东京湾的美国海军“密苏里”号战列舰上，举行了日本向同盟国投降的签字仪式。日本外相重光葵和日军参谋总长梅津美治郎代表日本政府在投降书上签字。随后，同盟国代表及包括中国代表徐永昌将军在内的各战胜国代表依次签字。这一仪式在法律上正式宣告了日本军国主义的彻底失败和第二次世界大战的结束。', '', '',],
                [4, '胜利时刻', '中国战区受降仪式', '中国人民扬眉吐气的历史时刻', '1945年9月9日', '南京受降仪式', '1945年9月9日，中国战区受降仪式在南京中央陆军军官学校大礼堂举行。日本中国派遣军总司令官冈村宁次大将代表日军向中国政府投降，并在投降书上签字，向中国战区最高统帅特派代表、中国陆军总司令何应钦上将呈交投降书。这一仪式标志着中国抗日战争暨世界反法西斯战争在中国战区的胜利结束。', '', '',],
                [5, '胜利时刻', '台湾光复', '重回祖国版图', '1945年10月25日', '台湾受降仪式', '根据《开罗宣言》和《波茨坦公告》，日本将窃取于中国的领土，如台湾、澎湖列岛等归还中国。1945年10月25日，中国战区台湾省受降仪式在台北公会堂（今中山堂）举行。日本原台湾总督兼第十方面军司令官安藤利吉大将向中国政府代表、台湾省行政长官陈仪投降。自此，被日本殖民统治达50年之久的台湾及其附属岛屿、澎湖列岛正式重归中国版图。', '', '',],
            ]
        );
    }

    /*
    // Use up()/down() to run migration code without a transaction.
    public function up()
    {

    }

    public function down()
    {
        echo "m251221_150458_create_table_timeline cannot be reverted.\n";

        return false;
    }
    */
}
